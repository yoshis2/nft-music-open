# 🗃️ データベース管理 (マイグレーション)

データベースのテーブル定義（スキーマ）を変更する際は、直接 SQL を実行するのではなく、`sql-migrate` を使ったマイグレーション機能を利用します。これにより、スキーマの変更履歴をバージョン管理でき、チーム内での共有も容易になります。

## マイグレーションの基本的な流れ

1.  **マイグレーションファイルの作成**

    以下のコマンドで、新しいマイグレーションファイルを作成します。`name`には、`create_users` や `add_email_to_users` のように、変更内容がわかる名前を指定してください。

    ```bash
    make table name=[MIGRATION_NAME]
    ```

    **例:** `nfts` テーブルを作成する場合

    ```bash
    make table name=create_nfts
    ```

    このコマンドを実行すると、`database/migrations/` ディレクトリに `YYYYMMDDHHMMSS_create_nfts.sql` のようなファイルが生成されます。

2.  **SQL の記述**

    生成された `.sql` ファイルを開き、`-- +migrate Up` と `-- +migrate Down` のセクションにそれぞれ SQL を記述します。

    - `-- +migrate Up`: マイグレーションを適用する際（テーブル作成やカラム追加など）に実行される SQL。
    - `-- +migrate Down`: マイグレーションを元に戻す際（テーブル削除やカラム削除など）に実行される SQL。

3.  **マイグレーションの実行**

    作成したマイグレーションをデータベースに反映させます。

    ```bash
    make migrate
    ```

    このコマンドで、まだ適用されていないマイグレーションが実行され、データベースのスキーマが更新されます。
